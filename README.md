# Sujet 2

### Objectif :

Vous devez réaliser une classe SignatureTools permettant de vérifier la signature de fichiers à partir de clés lues depuis un keystore.
Cette classe présente les méthodes suivantes :
* public SignatureTools(String file, char[] passwd, String type, String DN) qui construit une instance de la classe et initialise l'unique attribut dont elle doit disposer. Cet attribut doit être nommé pubKeys et de type ArrayList<PublicKey>. Il doit contenir toutes les clés publiques, issues des certificats présents dans le keystore stocké dans le fichier file, pour lesquels le Distinguished Name du sujet correspond à celui donné dans le paramètre DN. Ces certificats peuvent se trouver aussi bien dans des entrées de type clé que dans des entrées de type certificat. Le type du keystore est donné dans le paramètre type. Le mot de passe servant à protéger le keystore est donné dans le paramètre passwd.
* public boolean verify(String fileName, byte[] signature) qui va vérifier la signature signature du fichier fileName. Il s'agit d'une signature RSA, DSA ou ECDSA générée avec la fonction de hachage SHA-256. Pour la vérifier, la méthode doit utiliser successivement chacune des clés se trouvant dans l'attribut pubKeys. La méthode retourne "true" si l'une de ces clés permet de valider la signature, "false" sinon.
* public static void main(String[] args), la méthode principale qui sert à tester le bon fonctionnement de votre classe. Cette méthode doit créer une instance de SignatureTools en appelant son contructeur avec, parmis les paramètres, un keystore de type JCEKS que vous devez générer (pour vous faciliter la tâche, vous pouvez utiliser autant que possible l'outil keytool fourni dans le kit de développement standard de Java). Votre keystore peut être protégé avec le mot de passe de votre choix, et le fichier contenant ce keystore peut porter le nom de votre choix. Il doit contenir plusieurs entrées de test dont, au minimum, les 3 suivantes :
   1. une entrée de type clé privée ECDSA, dont le certificat contenant la clé publique associée pourra être autosigné (afin de vous faciliter la tâche. Il en va de même pour les autres certificats utilisés dans ce projet) ;
   2. une entrée de type clé privée DSA, dont le sujet du certificat contenant la clé publique associée doit avoir le même Distinguished Name que le sujet du certificat présent dans l'entrée décrite ci-dessous ;
   3. une entrée de type certificat, contenant un certificat encapsulant une clé publique RSA.
* Dans cette méthode main, vous devez ensuite générer plusieurs signatures d'un fichier quelconque. Ces signatures doivent être produites en utilisant différentes clés privées rangées dans les entrées de votre keystore. Au mininum, vous devez produire ces signatures en utilisant les clés privées associées aux clés publiques encapsulées dans les 3 certificats mentionnés ci-dessus. Enfin, la méthode main doit vérifier la validité de ces signatures en faisant appel à la méthode verify d'une instance de SignatureTools. Si l'une de ces signatures ne peut pas être validée, cela signifie qu'il y a un problème dans le code de votre classe.